
# v8rac
Библиотека для работы с консольной утилитой `rac` 

[![Stars](https://img.shields.io/github/stars/khorevaa/v8rac.svg?label=Github%20%E2%98%85&a)](https://github.com/khorevaa/v8rac/stargazers)
[![Release](https://img.shields.io/github/tag/khorevaa/v8rac.svg?label=Last%20release&a)](https://github.com/khorevaa/v8rac/releases)
[![Открытый чат проекта https://gitter.im/EvilBeaver/oscript-library](https://badges.gitter.im/khorevaa/v8rac.png)](https://gitter.im/EvilBeaver/oscript-library)

[![Build Status](https://travis-ci.org/khorevaa/v8rac.svg?branch=master)](https://travis-ci.org/khorevaa/v8rac)
[![Coverage Status](https://coveralls.io/repos/github/khorevaa/v8rac/badge.svg?branch=master)](https://coveralls.io/github/khorevaa/v8rac?branch=master)

## Возможности

Данная библиотека предназначена для облегчения работы с консольной утилитой `rac` для 1С

Упрощенная версия библиотеки [`irac`](https://github.com/arkuznetsov/irac).

> Функционал `irac` не используется, но возможно комбинирование работы двух библиотек

Реализован следующий функционал:

* НайтиИнформационнуюБазу
* СписокИнформационныхБаз
* СписокЛокальныхКластеров
* Управление сеансами и соединениями
    * СписокСоединенийИнформационнойБазы
    * СписокСеансовКластера
    * СписокСеансовИнформационнойБазы
    * ОтключитьСеансыИнформационнойБазы
    * ОтключитьСоединенияИнформационнойБазы
    * ОтключитьСеанс
    * ОтключитьСоединение
* Управление информационной базой 
    * СоздатьИнформационнуюБазу
    * УдалитьИнформационнуюБазу
    * ПолучитьПодробноеОписаниеИнформационнойБазы
* Управление блокировкой к информационной базе
    * БлокировкаИнформационнойБазы
    * СнятьБлокировкуИнформационнойБазы
    * БлокировкаРегламентныхЗаданий
    * СнятьБлокировкуРегламентныхЗаданий
* ВыполнитьКоманду

## Установка

Для установки необходимо:
* Скачать файл v8rac.ospx из раздела [releases](https://github.com/khorevaa/v8rac/releases)
* Воспользоваться командой:

```
opm install -f <ПутьКФайлу>
```
или установить с хаба пакетов

```
opm install v8rac
```

## Пример работы

* Подготовка 

    ```bsl

        АдресСервера = "localhost";
        ВерсияПлатформы = "8.3";

        УправлениеКластером = Новый УправлениеКластером;
        УправлениеКластером.УстановитьКластер(АдресСервера);
        УправлениеКластером.ИспользоватьВерсию(ВерсияПлатформы);
        
        // Если требуется нужно установить авторизация для администратора кластера
        // УправлениеКластером.УстановитьАвторизациюКластера(ПользовательКластера, ПарольКластера);
        
        УправлениеКластером.Подключить();
        
        ИмяИнформационнойбазы = "Тестовая_ИБ";
            
    ```
* Поиск информационной базы 

    ```bsl
        ИмяИнформационнойбазы = "Тестовая_ИБ";
        ИдентификаторИнформационнойбаза = УправлениеКластером.НайтиИнформационнуюБазу(ИмяИнформационнойбазы);
    ```

* Установка авторизации в информационной базе

     ```bsl
        ИмяИнформационнойбазы = "Тестовая_ИБ";
        ИдентификаторИнформационнойбаза = УправлениеКластером.НайтиИнформационнуюБазу(ИмяИнформационнойбазы);

        УправлениеКластером.УстановитьАвторизациюИнформационнойБазы(ИдентификаторИнформационнойбаза,"Администратор", "МируМир");
    ```

* Список локальных кластеров

     ```bsl
        МассивЛокальныхКластеров = УправлениеКластером.СписокЛокальныхКластеров();

    ```

* Список информационных баз

     ```bsl

        ТаблицаИБ =  УправлениеКластером.СписокИнформационныхБаз();

        // Или для определенного локального кластера
        МассивЛокальныхКластеров = УправлениеКластером.СписокЛокальныхКластеров();
        ТаблицаИБ =  УправлениеКластером.СписокИнформационныхБаз(МассивЛокальныхКластеров[0]);

 
    ```
* Блокировка информационной базы

     ```bsl

        ИмяИнформационнойбазы = "Тестовая_ИБ";

        УправлениеКластером.БлокировкаИнформационнойБазы(ИмяИнформационнойбазы, "Сообщение блокировки", "КлючДоступа");  
    ```

* Снятие блокировки информационной базы

     ```bsl

        ИмяИнформационнойбазы = "Тестовая_ИБ";
        УправлениеКластером.СнятьБлокировкуИнформационнойБазы(ИмяИнформационнойбазы);
 
    ```
  
* Отключение сеансов информационный базы
    ```bsl 

        ИмяИнформационнойбазы = "Тестовая_ИБ";
        УправлениеКластером.ОтключитьСеансыИнформационнойБазы(ИмяИнформационнойбазы);
 
    ```

* Список сеансов информационный базы
    ```bsl 

        ИмяИнформационнойбазы = "Тестовая_ИБ";
        ТаблицаСеансов = УправлениеКластером.СписокСеансовИнформационнойБазы(ИмяИнформационнойбазы);
 
    ```

* Отключение соединений информационный базы
    ```bsl 

        ИмяИнформационнойбазы = "Тестовая_ИБ";
        УправлениеКластером.ОтключитьСоединенияИнформационнойБазы(ИмяИнформационнойбазы);

    ```

* Список соединений информационный базы
    ```bsl 

        ИмяИнформационнойбазы = "Тестовая_ИБ";
        ТаблицаСоединений = УправлениеКластером.СписокСоединенийИнформационнойБазы(ИмяИнформационнойбазы);
 
    ```

## Публичный интерфейс

[Документация публичного интерфейса (в разработке)](docs/README.md)

## Доработка

Актуальные задачи в файле [`TODO`](TODO).

Доработка проводится по git-flow. Жду ваших PR.

## Лицензия

Смотри файл [`LICENSE`](LICENSE).
